<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>QRã‚³ãƒ¼ãƒ‰ç”Ÿæˆ - ã‚«ãƒ©ãƒ¼&ã‚·ã‚§ã‚¤ãƒ—ã‚¨ã‚¯ã‚¹ãƒ—ãƒ­ãƒ¼ãƒ©ãƒ¼</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: 'Noto Sans JP', sans-serif; background: linear-gradient(135deg,#667eea 0%,#764ba2 100%); min-height: 100vh; padding: 2rem; }
    .container { max-width: 1100px; margin: 0 auto; }
    h1 { text-align: center; color: #fff; margin-bottom: 2rem; font-size: 1.9rem; }
    .qr-grid { display: grid; grid-template-columns: repeat(auto-fit,minmax(360px,1fr)); gap: 2rem; }
    .qr-card { background: #fff; border-radius: 12px; padding: 1.5rem; box-shadow: 0 10px 28px rgba(0,0,0,0.25); }
    .qr-card h2 { margin-bottom: 1rem; color: #333; font-size: 1.4rem; }
    .form-group { margin-bottom: 1rem; }
    .form-group label { display: block; margin-bottom: .4rem; color: #333; font-weight: 600; }
    .form-group input { width: 100%; padding: .75rem; border: 1px solid #ccc; border-radius: 6px; font-size: 1rem; }
    .hint { color: #64748b; font-size: .85rem; margin-top: .25rem; }
    .qr-code { display: inline-block; margin: 1rem 0; padding: 1rem; background: #fff; border: 2px solid #e0e0e0; border-radius: 8px; }
    .access-url { background: #f5f5f5; padding: 1rem; border-radius: 6px; font-size: .9rem; color: #333; font-family: monospace; word-break: break-all; }
    .button-group { display: flex; gap: .8rem; justify-content: center; margin-top: 1rem; flex-wrap: wrap; }
    button { padding: .7rem 1.4rem; border: none; border-radius: 6px; cursor: pointer; font-weight: 600; font-size: 1rem; transition: all .25s ease; }
    .btn-copy { background: #2196F3; color: #fff; }
    .btn-copy:hover { background: #0b7dda; }
    .btn-print { background: #4CAF50; color: #fff; }
    .btn-print:hover { background: #45a049; }
    .instructions { background: #fff; border-radius: 12px; padding: 1.5rem; box-shadow: 0 10px 28px rgba(0,0,0,0.25); }
    .instructions h3 { color: #333; margin-bottom: .8rem; }
    .instructions ol { color: #666; margin-left: 1.2rem; line-height: 1.8; }
    .instructions li { margin-bottom: .5rem; }
    @media print { body{ background:#fff; padding:0; } .instructions,.button-group{ display:none; } .qr-grid{ display:flex; flex-direction:column; } .qr-card{ page-break-inside:avoid; box-shadow:none; border:1px solid #ddd; } }
  </style>
</head>
<body>
  <div class="container">
    <h1>ğŸ“± QRã‚³ãƒ¼ãƒ‰ç”Ÿæˆãƒšãƒ¼ã‚¸</h1>
    <p style="text-align:center;color:#fff;margin-bottom:1.5rem;">ç™ºè¡¨ä¼šç”¨ - ãƒ•ãƒ­ãƒ³ãƒˆã®å…¬é–‹URLï¼ˆVercelæ¨å¥¨ï¼‰ã§QRã‚’ä½œæˆã—ã¾ã™</p>

    <div class="qr-grid">
      <div class="qr-card">
        <h2>QRã‚³ãƒ¼ãƒ‰è¨­å®š</h2>
        <div class="form-group">
          <label>ãƒã‚¹ã‚¿ãƒ¼ã‚¿ã‚¤ãƒˆãƒ«</label>
          <input id="titleInput" type="text" value="ã‚«ãƒ©ãƒ¼&ã‚·ã‚§ã‚¤ãƒ—ã‚¨ã‚¯ã‚¹ãƒ—ãƒ­ãƒ¼ãƒ©ãƒ¼" />
        </div>
        <div class="form-group">
          <label>ãƒ•ãƒ­ãƒ³ãƒˆURLï¼ˆæ¨å¥¨: Vercelã®URLï¼‰</label>
          <input id="fullUrlInput" type="text" placeholder="ä¾‹: https://your-app.vercel.app" />
          <div class="hint">å…¥åŠ›ã•ã‚Œã¦ã„ã‚Œã°ã“ã¡ã‚‰ã‚’å„ªå…ˆã—ã¾ã™ã€‚æœ«å°¾ã« /index.html ã‚’è‡ªå‹•è£œå®Œã—ã¾ã™ã€‚</div>
        </div>
        <div class="form-group">
          <label>å…±æœ‰ç”¨ãƒ›ã‚¹ãƒˆ/IPï¼ˆä¾‹: 192.168.0.9ï¼‰</label>
          <input id="hostInput" type="text" placeholder="ä¾‹: 192.168.0.9" />
          <div class="hint">Wiâ€‘Fiãƒ­ãƒ¼ã‚«ãƒ«ç”¨ã®äºˆå‚™è¨­å®šã€‚ä¸ŠãŒç©ºã®ã¨ãã«ä½¿ç”¨ã—ã¾ã™ã€‚</div>
        </div>
        <div class="form-group">
          <label>ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãƒãƒ¼ãƒˆ</label>
          <input id="portInput" type="text" value="8080" />
        </div>

        <div id="qrCode" class="qr-code"></div>
        <div id="urlDisplay" class="access-url"></div>
        <div class="button-group">
          <button class="btn-copy" onclick="copyQRUrl()">ğŸ”— URLã‚’ã‚³ãƒ”ãƒ¼</button>
          <button class="btn-print" onclick="window.print()">ğŸ–¨ï¸ ãƒã‚¹ã‚¿ãƒ¼ã‚’å°åˆ·</button>
        </div>
      </div>
    </div>

    <div class="instructions" style="margin-top:1.5rem;">
      <h3>ğŸ“‹ ä½¿ã„æ–¹</h3>
      <ol>
        <li>ãƒ•ãƒ­ãƒ³ãƒˆURLï¼ˆVercelå…¬é–‹URLï¼‰ã‚’å…¥åŠ›ã—ã¾ã™ã€‚ä¾‹: https://your-app.vercel.app</li>
        <li>ãƒ­ãƒ¼ã‚«ãƒ«é…ä¿¡ç”¨ã«ä½¿ã†å ´åˆã¯ã€ãƒ›ã‚¹ãƒˆã¨ãƒãƒ¼ãƒˆã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚</li>
        <li>QRã‚³ãƒ¼ãƒ‰ãŒè‡ªå‹•ç”Ÿæˆã•ã‚Œã¾ã™ã€‚å°åˆ·ã—ã¦æ²ç¤ºã—ã¦ãã ã•ã„ã€‚</li>
      </ol>
    </div>
  </div>

  <script>
    let currentQRCode = null;

    function normalizeFrontendUrl(raw) {
      if (!raw) return '';
      let url = raw.trim();
      if (!/^https?:\/\//i.test(url)) { url = 'https://' + url; }
      try {
        const u = new URL(url);
        if (!u.pathname || u.pathname === '/') { u.pathname = '/index.html'; return u.toString(); }
        return url;
      } catch (_) { return url; }
    }

    function buildAccessUrl() {
      const fullUrlInput = document.getElementById('fullUrlInput');
      const hostInput = document.getElementById('hostInput');
      const portInput = document.getElementById('portInput');

      const fullUrl = normalizeFrontendUrl(fullUrlInput.value);
      if (fullUrl) return fullUrl;

      const host = (hostInput.value || '').trim();
      const port = (portInput.value || '8080').trim();
      if (!host) return '';
      return `http://${host}:${port}/index.html`;
    }

    function renderQRCode() {
      const accessUrl = buildAccessUrl();
      const urlDisplay = document.getElementById('urlDisplay');
      const qrContainer = document.getElementById('qrCode');

      if (!accessUrl) {
        urlDisplay.textContent = 'âš  ã¾ãšãƒ•ãƒ­ãƒ³ãƒˆURLã€ã¾ãŸã¯ãƒ›ã‚¹ãƒˆ/IPã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚';
        qrContainer.innerHTML = '';
        return;
      }

      urlDisplay.textContent = accessUrl;
      qrContainer.innerHTML = '';
      currentQRCode = new QRCode(qrContainer, {
        text: accessUrl,
        width: 300,
        height: 300,
        colorDark: '#000000',
        colorLight: '#ffffff',
        correctLevel: QRCode.CorrectLevel.H,
      });
    }

    function copyQRUrl() {
      const url = document.getElementById('urlDisplay').textContent;
      if (!url) return alert('URLãŒæœªè¨­å®šã§ã™');
      navigator.clipboard.writeText(url).then(() => alert('URLã‚’ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼'));
    }

    document.addEventListener('DOMContentLoaded', () => {
      const initialHost = window.location.hostname || '';
      const hostInput = document.getElementById('hostInput');
      if (hostInput && !hostInput.value) hostInput.value = initialHost;
      ['titleInput','fullUrlInput','hostInput','portInput'].forEach(id => {
        const el = document.getElementById(id);
        if (el) el.addEventListener('input', renderQRCode);
      });
      renderQRCode();
    });
  </script>
</body>
</html>
